@using Glide.Web.Labels
<!-- Update label option buttons in the picker menu -->
@foreach (var label in AllBoardLabels)
{
    var isSelected = Card.Labels.Any(c => c.Id == label.Id);
    if (isSelected)
    {
        <button type="button"
                class="label-option selected"
                hx-delete="/cards/@Card.Id/labels/@label.Id"
                hx-target="#label-options-@Card.Id"
                hx-swap="innerHTML">
            <span class="label-badge">@label.Name</span>
            <span class="label-action">âœ“</span>
        </button>
    }
    else
    {
        <button type="button"
                class="label-option"
                hx-post="/cards/@Card.Id/labels"
                hx-vals='{"label_id": "@label.Id"}'
                hx-target="#label-options-@Card.Id"
                hx-swap="innerHTML">
            <span class="label-badge">@label.Name</span>
            <span class="label-action">+</span>
        </button>
    }
}

<!-- Update label preview in the modal using out-of-band swap -->
<div hx-swap-oob="innerHTML:#card-labels-@Card.Id">
    <LabelList Labels="@Card.Labels"/>
</div>

<!-- Update card in the board view using out-of-band swap -->
<div hx-swap-oob="outerHTML:#card-@Card.Id">
    <CardCard Card="@Card"/>
</div>

@code {
    [Parameter] public required CardView Card { get; set; }

    [Parameter] public required IEnumerable<LabelView> AllBoardLabels { get; set; }
}
